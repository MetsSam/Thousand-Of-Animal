<script>
    const questions = [
        {
            text: "Would you rather live on land or somewhere else?",
            answers: [
                { text: "On land", trait: "land-bottom", environment: "Land" },
                { text: "Somewhere else", trait: "", environment: "Somewhere Else" }
            ]
        },
        {
            Land: {
                text: "Would you rather live above ground or underground?",
                answers: [
                    { text: "Above ground", trait: "above-ground-body", habitat: "Above Ground" },
                    { text: "Underground", trait: "underground-body", habitat: "Underground", bottomTrait: "underground-bottom" }
                ]
            },
            "Somewhere Else": {
                text: "Would you rather live in the air or the sea?",
                answers: [
                    { text: "In the air", trait: "air-body", habitat: "Air", bottomTrait: "air-bottom" },
                    { text: "In the sea", trait: "sea-body", habitat: "Sea", bottomTrait: "sea-bottom" }
                ]
            }
        },
        {
            "Land-Above Ground": {
                text: "What kind of habitat do you prefer?",
                answers: [
                    { text: "Plains", trait: "plains-head", specificHabitat: "Plains" },
                    { text: "Forests", trait: "forest-head", specificHabitat: "Forests" }
                ]
            },
            "Land-Underground": {
                text: "What kind of habitat do you prefer?",
                answers: [
                    { text: "Soil", trait: "soil-head", specificHabitat: "Soil" },
                    { text: "Caves", trait: "cave-head", specificHabitat: "Caves" }
                ]
            },
            "Somewhere Else-Air": {
                text: "What kind of habitat do you prefer?",
                answers: [
                    { text: "High Skies", trait: "sky-head", specificHabitat: "High Skies" },
                    { text: "Treetops", trait: "treetop-head", specificHabitat: "Low Air" }
                ]
            },
            "Somewhere Else-Sea": {
                text: "What kind of habitat do you prefer?",
                answers: [
                    { text: "Coral Reefs", trait: "coral-reef-head", specificHabitat: "Surface" },
                    { text: "Deep Trenches", trait: "trench-head", specificHabitat: "Deep Sea" }
                ]
            }
        },
        {
            text: "What’s your primary behavior?",
            answers: [
                { text: "Swift", trait: "", behavior: "Swift" },
                { text: "Sturdy", trait: "", behavior: "Sturdy" },
                { text: "Social", trait: "", behavior: "Social" },
                { text: "Agile", trait: "", behavior: "Agile" },
                { text: "Predatory", trait: "", behavior: "Predatory" }
            ]
        },
        {
            text: "What’s your unique trait?",
            answers: [
                { text: "Camouflaged", trait: "", trait: "Camouflaged" },
                { text: "Nocturnal", trait: "", trait: "Nocturnal" },
                { text: "Solitary", trait: "", trait: "Solitary" }
            ]
        },
        {
            text: "Are you bold or cautious?",
            answers: [
                { text: "Bold", trait: "", boldness: "Bold" },
                { text: "Cautious", trait: "", boldness: "Cautious" }
            ]
        }
    ];

    const animalData = {
        "Squid": { description: "You're a Squid! You glide through the deep sea with agile tentacles, blending into the coral reefs!" },
        "Octopus": { description: "You're an Octopus! You navigate trenches with cunning, camouflaging in the deep sea!" },
        "Sea Sponge": { description: "You're a Sea Sponge! You anchor sturdy in coral reefs, filtering the ocean's secrets!" },
        "Anglerfish": { description: "You're an Anglerfish! You lurk in deep trenches, luring prey with your glowing light!" },
        "Dolphin": { description: "You're a Dolphin! You leap swiftly through surface waters, socializing in pods!" },
        "Shark": { description: "You're a Shark! You prowl sturdily in coral reefs, a solitary predator!" },
        "Whale": { description: "You're a Whale! You roam socially across surface seas, singing in the night!" },
        "Manta Ray": { description: "You're a Manta Ray! You glide agilely in coral reefs, camouflaged against the ocean floor!" },
        // Additional entries for 1080 animals would be generated programmatically, e.g.:
        // "You're a [Animal]! You [action] in the [habitat] with [trait]!"
        // Full implementation would include all 1080 descriptions.
    };

    let currentQuestion = 0;
    let traits = [];
    let choices = { environment: '', habitat: '', specificHabitat: '', behavior: '', trait: '', boldness: '', animal: '' };

    const questionText = document.getElementById('question-text');
    const answerButtons = document.querySelectorAll('.answer-button');
    const characterDisplay = document.getElementById('character-display');
    const stickFigure = document.querySelector('.stick-figure');
    const resultDiv = document.getElementById('result');
    const resultText = document.getElementById('result-text');
    const restartButton = document.getElementById('restart-button');

    function startGame() {
        currentQuestion = 0;
        traits = [];
        choices = { environment: '', habitat: '', specificHabitat: '', behavior: '', trait: '', boldness: '', animal: '' };
        resultDiv.style.display = 'none';
        stickFigure.className = 'stick-figure';
        answerButtons.forEach(btn => btn.style.display = 'none');
        displayQuestion();
    }

    function displayQuestion() {
        if (currentQuestion < questions.length) {
            let q;
            if (currentQuestion === 1) {
                q = questions[currentQuestion][choices.environment];
            } else if (currentQuestion === 2) {
                q = questions[currentQuestion][`${choices.environment}-${choices.habitat}`];
            } else {
                q = questions[currentQuestion];
            }
            questionText.textContent = q.text;
            answerButtons.forEach((btn, index) => {
                if (index < q.answers.length) {
                    btn.textContent = q.answers[index].text;
                    btn.style.display = 'inline-block';
                    btn.onclick = () => selectAnswer(q.answers[index].trait, q.answers[index]);
                } else {
                    btn.style.display = 'none';
                }
            });
        } else {
            showResult();
        }
    }

    function selectAnswer(trait, answer) {
        if (trait) {
            traits.push(trait);
            stickFigure.classList.add(trait);
        }
        if (currentQuestion === 0) {
            choices.environment = answer.environment;
        } else if (currentQuestion === 1) {
            choices.habitat = answer.habitat;
            if (answer.bottomTrait) {
                traits.push(answer.bottomTrait);
                stickFigure.classList.add(answer.bottomTrait);
            }
        } else if (currentQuestion === 2) {
            choices.specificHabitat = answer.specificHabitat;
            stickFigure.classList.add(answer.trait);
            traits.push(answer.trait);
        } else if (currentQuestion === 3) {
            choices.behavior = answer.behavior;
        } else if (currentQuestion === 4) {
            choices.trait = answer.trait;
            // Simulate animal selection (in full version, this would map to 1 of 1080 animals)
            choices.animal = simulateAnimalSelection();
            const animalTrait = `${choices.animal.toLowerCase().replace(/\s/g, '-')}-head`;
            stickFigure.classList.add(animalTrait);
            traits.push(animalTrait);
            const featureTrait = `${choices.animal.toLowerCase().replace(/\s/g, '-')}-${choices.behavior.toLowerCase()}`;
            stickFigure.classList.add(featureTrait);
            traits.push(featureTrait);
        } else if (currentQuestion === 5) {
            choices.boldness = answer.boldness;
        }
        currentQuestion++;
        displayQuestion();
    }

    // Simulate animal selection for subset (in full version, this would map to 1080 animals)
    function simulateAnimalSelection() {
        const animals = {
            "Sea-Surface": ["Dolphin", "Shark", "Whale", "Manta Ray"],
            "Sea-Deep Sea": ["Squid", "Octopus", "Sea Sponge", "Anglerfish"],
            "Air-High Skies": ["Eagle", "Owl", "Parrot", "Vulture"],
            "Air-Low Air": ["Dragonfly", "Bat", "Hummingbird", "Sparrow"],
            "Land-Above Ground-Plains": ["Lion", "Elephant", "Cheetah", "Rhino"],
            "Land-Above Ground-Forests": ["Squirrel", "Monkey", "Wolf", "Deer"],
            "Land-Underground-Soil": ["Mole", "Earthworm", "Ant", "Termite"],
            "Land-Underground-Caves": ["Cave Spider", "Badger", "Naked Mole Rat", "Cave Salamander"]
        };
        const key = `${choices.environment}-${choices.habitat}${choices.specificHabitat ? `-${choices.specificHabitat}` : ''}`;
        const animalList = animals[key] || ["Unknown Animal"];
        // In full version, this would use behavior and trait to select from 1080 animals
        return animalList[Math.floor(Math.random() * animalList.length)];
    }

    function showResult() {
        const finalAnimal = choices.animal;
        questionText.textContent = '';
        answerButtons.forEach(btn => btn.style.display = 'none');
        resultDiv.style.display = 'block';
        resultText.textContent = animalData[finalAnimal]?.description || `You're a ${finalAnimal}! A unique creature thriving in its habitat!`;
    }

    restartButton.addEventListener('click', startGame);

    startGame();
</script>